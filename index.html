<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>ğŸ“š Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª PWA -->
    <meta name="theme-color" content="#6c5ce7">
    <meta name="description" content="Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© Ù„Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“š</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“š</text></svg>">
    
    <style>
        /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            line-height: 1.6;
            color: #333;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        #splashScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }
        
        .splash-icon {
            font-size: 4rem;
            color: white;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }
        
        .splash-title {
            color: white;
            font-size: 2.5rem;
            font-weight: 800;
            text-align: center;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .splash-text {
            color: white;
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 30px;
        }
        
        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        #appContent {
            display: none;
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 80px;
        }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .app-header {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            padding: 25px 20px;
            border-radius: 20px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
            position: relative;
        }
        
        .app-title {
            color: #2d3436;
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .app-title i {
            color: #6c5ce7;
            font-size: 2.2rem;
        }
        
        .app-subtitle {
            color: #636e72;
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        /* Ø²Ø± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
        .btn-install {
            background: linear-gradient(135deg, #00cec9 0%, #0984e3 100%);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 25px;
            font-family: 'Cairo', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(9, 132, 227, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            z-index: 1000;
            position: absolute;
            left: 20px;
            top: 20px;
        }
        
        .btn-install:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(9, 132, 227, 0.4);
        }
        
        .btn-install.installed {
            background: linear-gradient(135deg, #00b894 0%, #55efc4 100%);
            cursor: default;
        }
        
        .btn-install.installed:hover {
            transform: none;
            box-shadow: 0 4px 12px rgba(9, 132, 227, 0.3);
        }
        
        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        
        .card-title {
            color: #2d3436;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f1f2f6;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .card-title i {
            color: #6c5ce7;
        }
        
        /* Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            color: #2d3436;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-label i {
            color: #6c5ce7;
            font-size: 1.2rem;
        }
        
        .form-control {
            width: 100%;
            padding: 15px;
            border: 2px solid #dfe6e9;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Cairo', sans-serif;
            background: white;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #6c5ce7;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1);
        }
        
        select.form-control {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: left 15px center;
            background-size: 20px;
            padding-right: 15px;
        }
        
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }
        
        /* ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ */
        .dates-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .date-box {
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(108, 92, 231, 0.3);
        }
        
        .date-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .date-value {
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ */
        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        /* ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£ÙŠØ§Ù… */
        #daysContainer {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .day-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            border-right: 5px solid;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }
        
        .day-card:hover {
            transform: translateX(-5px);
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .day-name {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .day-icon {
            font-size: 1.4rem;
        }
        
        .day-date {
            color: #636e72;
            font-size: 0.95rem;
            background: #f8f9fa;
            padding: 5px 12px;
            border-radius: 20px;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
        .control-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0984e3 0%, #00cec9 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(9, 132, 227, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(9, 132, 227, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00b894 0%, #55efc4 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3);
        }
        
        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 184, 148, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #fdcb6e 0%, #ffeaa7 100%);
            color: #2d3436;
            box-shadow: 0 5px 15px rgba(253, 203, 110, 0.3);
        }
        
        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(253, 203, 110, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e17055 0%, #fab1a0 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(225, 112, 85, 0.3);
        }
        
        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(225, 112, 85, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #a29bfe 0%, #dfe6e9 100%);
            color: #2d3436;
            box-shadow: 0 5px 15px rgba(162, 155, 254, 0.2);
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(162, 155, 254, 0.3);
        }
        
        .btn-clear {
            width: 100%;
            background: linear-gradient(135deg, #dfe6e9 0%, #b2bec3 100%);
            color: #2d3436;
            box-shadow: 0 5px 15px rgba(178, 190, 195, 0.2);
        }
        
        .btn-clear:hover {
            background: linear-gradient(135deg, #b2bec3 0%, #636e72 100%);
            color: white;
        }
        
        /* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            text-align: center;
            z-index: 1000;
            display: none;
            backdrop-filter: blur(10px);
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #6c5ce7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        .loading-text {
            color: #2d3436;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .message {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
            text-align: center;
            font-weight: 600;
            border-right: 5px solid;
            backdrop-filter: blur(10px);
            animation: slideDown 0.5s ease;
        }
        
        .message.success {
            background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
            color: white;
            border-right-color: #00b894;
        }
        
        .message.error {
            background: linear-gradient(135deg, #fab1a0 0%, #e17055 100%);
            color: white;
            border-right-color: #e17055;
        }
        
        .message.info {
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
            color: white;
            border-right-color: #6c5ce7;
        }
        
        /* Ø§Ù„ÙÙˆØªØ± */
        .footer {
            text-align: center;
            padding: 25px 20px;
            color: white;
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .footer p {
            margin-bottom: 8px;
            opacity: 0.9;
        }
        
        .version {
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        /* Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 768px) {
            .app-title {
                font-size: 1.8rem;
            }
            
            .card-title {
                font-size: 1.3rem;
            }
            
            .control-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-buttons {
                grid-template-columns: 1fr;
            }
            
            .dates-container {
                grid-template-columns: 1fr;
            }
            
            .day-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .btn-install {
                position: fixed !important;
                bottom: 20px;
                right: 20px;
                left: auto;
                top: auto;
                padding: 12px 20px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .app-title {
                font-size: 1.5rem;
            }
            
            .card {
                padding: 20px;
            }
            
            .btn {
                padding: 14px;
                font-size: 0.95rem;
            }
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø¹Ù„Ù‰ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .form-control:invalid {
            border-color: #e17055;
        }
        
        .form-control:valid {
            border-color: #55efc4;
        }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div id="splashScreen">
        <div class="splash-icon">ğŸ“š</div>
        <h1 class="splash-title">Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</h1>
        <p class="splash-text">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</p>
        <div id="progressBar" style="width: 200px; height: 6px; background: rgba(255,255,255,0.3); border-radius: 3px; overflow: hidden;">
            <div id="progressFill" style="width: 0%; height: 100%; background: white; transition: width 0.5s;"></div>
        </div>
    </div>
    
    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div id="appContent">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <div class="app-header">
            <button id="installButton" class="btn-install" style="display: none;">
                <i class="fas fa-download"></i> ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            </button>
            
            <h1 class="app-title">
                <i class="fas fa-chalkboard-teacher"></i>
                Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©
            </h1>
            <p class="app-subtitle">Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - Ù…ØµÙ…Ù… Ø®ØµÙŠØµØ§Ù‹ Ù„Ù„Ù‡Ø§ØªÙ</p>
        </div>
        
        <!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
        <div class="card">
            <h3 class="card-title"><i class="fas fa-cog"></i> Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
            
            <div class="form-group">
                <label class="form-label"><i class="fas fa-graduation-cap"></i> Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                <select id="grade" class="form-control" required>
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>
                    <option value="Ø§Ù„Ø£ÙˆÙ„">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„</option>
                    <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                    <option value="Ø§Ù„Ø«Ø§Ù„Ø«">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                    <option value="Ø§Ù„Ø±Ø§Ø¨Ø¹">Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
                    <option value="Ø§Ù„Ø®Ø§Ù…Ø³">Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³</option>
                    <option value="Ø§Ù„Ø³Ø§Ø¯Ø³">Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³</option>
                    <option value="Ø§Ù„Ø³Ø§Ø¨Ø¹">Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¨Ø¹</option>
                    <option value="Ø§Ù„Ø«Ø§Ù…Ù†">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù…Ù†</option>
                    <option value="Ø§Ù„ØªØ§Ø³Ø¹">Ø§Ù„ØµÙ Ø§Ù„ØªØ§Ø³Ø¹</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label"><i class="fas fa-users"></i> Ø§Ù„Ø´Ø¹Ø¨Ø©</label>
                <select id="class" class="form-control" required>
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ø¹Ø¨Ø©</option>
                    <option value="Ø£">Ø§Ù„Ø´Ø¹Ø¨Ø© Ø£</option>
                    <option value="Ø¨">Ø§Ù„Ø´Ø¹Ø¨Ø© Ø¨</option>
                    <option value="Ø¬">Ø§Ù„Ø´Ø¹Ø¨Ø© Ø¬</option>
                    <option value="Ø¯">Ø§Ù„Ø´Ø¹Ø¨Ø© Ø¯</option>
                    <option value="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label"><i class="fas fa-book"></i> Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
                <select id="subject" class="form-control" required>
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</option>
                    <option value="Ù‚Ø±Ø¢Ù†">Ù‚Ø±Ø¢Ù†</option>
                    <option value="Ø¥Ø³Ù„Ø§Ù…ÙŠØ©">Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</option>
                    <option value="Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©">Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©</option>
                    <option value="Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©">Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                    <option value="Ø±ÙŠØ§Ø¶ÙŠØ§Øª">Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
                    <option value="Ø¹Ù„ÙˆÙ…">Ø¹Ù„ÙˆÙ…</option>
                    <option value="Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª">Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label"><i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <input type="text" id="teacher" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù„Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©">
            </div>
        </div>
        
        <!-- ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ -->
        <div class="card">
            <h3 class="card-title"><i class="fas fa-calendar-alt"></i> ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h3>
            
            <div class="dates-container" id="weekDates">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
            </div>
            
            <div class="nav-buttons">
                <button class="btn btn-secondary" onclick="navigateWeek(-1)">
                    <i class="fas fa-chevron-right"></i> Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ù‚
                </button>
                <button class="btn btn-secondary" onclick="loadCurrentWeek()">
                    <i class="fas fa-sync"></i> Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
                </button>
                <button class="btn btn-secondary" onclick="navigateWeek(1)">
                    Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-chevron-left"></i>
                </button>
            </div>
        </div>
        
        <!-- ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£ÙŠØ§Ù… -->
        <div class="card">
            <h3 class="card-title"><i class="fas fa-tasks"></i> ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h3>
            <div id="daysContainer">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
            </div>
        </div>
        
        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="card">
            <h3 class="card-title"><i class="fas fa-sliders-h"></i> Ø§Ù„ØªØ­ÙƒÙ…</h3>
            
            <div class="control-grid">
                <button class="btn btn-primary" onclick="loadHomework()">
                    <i class="fas fa-search"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
                <button class="btn btn-success" onclick="saveHomework()">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
                <button class="btn btn-warning" onclick="updateHomework()">
                    <i class="fas fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
                <button class="btn btn-danger" onclick="deleteHomework()">
                    <i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
            </div>
            
            <button class="btn btn-clear" onclick="clearForm()">
                <i class="fas fa-broom"></i> ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
            </button>
        </div>
        
        <!-- Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
        <div class="loading" id="formLoading">
            <div class="spinner"></div>
            <p class="loading-text">Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
        </div>
        
        <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
        <div id="message" class="message"></div>
        
        <!-- Ø§Ù„ÙÙˆØªØ± -->
        <div class="footer">
            <p>Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© &copy; 2023</p>
            <p class="version">Ù…ØµÙ…Ù… Ø®ØµÙŠØµØ§Ù‹ Ù„Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„</p>
            <p class="version">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© ÙÙŠ Google Sheets</p>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
    // ============ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ============
    const TEACHER_API_URL = 'https://script.google.com/macros/s/AKfycbwJiw7_R3k5o8cgL1PxFZdSI9C9GFwGjKBwzT4RoymAz-XvQmDWLiaIyoodEdOEbM7P/exec';
    
    let currentWeekStart = null;
    let currentWeekEnd = null;
    
    const daysOfWeek = [
        { id: 'Ø§Ù„Ø³Ø¨Øª', icon: 'fas fa-calendar-day', color: '#3498db', english: 'saturday' },
        { id: 'Ø§Ù„Ø£Ø­Ø¯', icon: 'fas fa-sun', color: '#f39c12', english: 'sunday' },
        { id: 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', icon: 'fas fa-moon', color: '#9b59b6', english: 'monday' },
        { id: 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', icon: 'fas fa-star', color: '#e74c3c', english: 'tuesday' },
        { id: 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', icon: 'fas fa-cloud', color: '#1abc9c', english: 'wednesday' }
    ];
    
    // ============ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ============
    window.addEventListener('load', function() {
        const progressFill = document.getElementById('progressFill');
        let progress = 0;
        
        const progressInterval = setInterval(() => {
            progress += 10;
            progressFill.style.width = progress + '%';
            
            if (progress >= 100) {
                clearInterval(progressInterval);
                setTimeout(() => {
                    document.getElementById('splashScreen').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('splashScreen').style.display = 'none';
                        document.getElementById('appContent').style.display = 'block';
                        initApp();
                    }, 500);
                }, 500);
            }
        }, 200);
    });
    
    function initApp() {
        calculateCurrentWeek();
        renderWeekDates();
        renderDays();
        setupEventListeners();
        setupPWA();
        testConnection();
    }
    
    // ============ PWA Installation ============
    let deferredPrompt;
    const installButton = document.getElementById('installButton');
    
    function setupPWA() {
        // Ø§Ø³ØªÙ…Ø¹ Ù„Ø­Ø¯Ø« beforeinstallprompt
        window.addEventListener('beforeinstallprompt', (e) => {
            // Ù…Ù†Ø¹ Ø§Ù„Ù…ØªØµÙØ­ Ù…Ù† Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
            e.preventDefault();
            
            // Ø­ÙØ¸ Ø§Ù„Ø­Ø¯Ø« Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹
            deferredPrompt = e;
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ø®Ø§Øµ Ø¨Ù†Ø§
            if (installButton) {
                installButton.style.display = 'flex';
                
                // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
                installButton.addEventListener('click', async () => {
                    if (deferredPrompt) {
                        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØµÙØ­
                        deferredPrompt.prompt();
                        
                        // Ø§Ù†ØªØ¸Ø§Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                        const { outcome } = await deferredPrompt.userChoice;
                        
                        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©
                        console.log(`Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ${outcome === 'accepted' ? 'Ù‚Ø¨Ù„' : 'Ø±ÙØ¶'} Ø§Ù„ØªØ«Ø¨ÙŠØª`);
                        
                        if (outcome === 'accepted') {
                            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø²Ø±
                            installButton.innerHTML = '<i class="fas fa-check"></i> Ù…Ø«Ø¨Øª';
                            installButton.classList.add('installed');
                            installButton.disabled = true;
                            
                            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                            showMessage('âœ… ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                        }
                        
                        // Ù…Ø³Ø­ Ø§Ù„Ù…ØªØºÙŠØ±
                        deferredPrompt = null;
                    }
                });
            }
        });
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø«Ø¨ØªØ§Ù‹ Ø¨Ø§Ù„ÙØ¹Ù„
        window.addEventListener('appinstalled', () => {
            console.log('Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø«Ø¨Øª Ø¨Ù†Ø¬Ø§Ø­');
            deferredPrompt = null;
            
            if (installButton) {
                installButton.innerHTML = '<i class="fas fa-check"></i> Ù…Ø«Ø¨Øª';
                installButton.classList.add('installed');
                installButton.disabled = true;
                installButton.style.display = 'flex';
            }
        });
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¶Ø¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø«Ø¨Øª
        function checkDisplayMode() {
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ¹Ù…Ù„ ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø«Ø¨Øª');
                document.body.classList.add('standalone-mode');
                
                if (installButton) {
                    installButton.innerHTML = '<i class="fas fa-check"></i> Ù…Ø«Ø¨Øª';
                    installButton.classList.add('installed');
                    installButton.disabled = true;
                }
            }
        }
        
        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        checkDisplayMode();
        
        // Service Worker Ù„Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').then(registration => {
                    console.log('ServiceWorker registered: ', registration.scope);
                }).catch(error => {
                    console.log('ServiceWorker registration failed: ', error);
                });
            });
        }
    }
    
    // ============ Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® ============
    function calculateCurrentWeek() {
        const today = new Date();
        const dayOfWeek = today.getDay();
        
        let daysSinceSaturday;
        if (dayOfWeek === 6) {
            daysSinceSaturday = 0;
        } else if (dayOfWeek === 0) {
            daysSinceSaturday = 6;
        } else {
            daysSinceSaturday = dayOfWeek + 1;
        }
        
        const lastSaturday = new Date(today);
        lastSaturday.setDate(today.getDate() - daysSinceSaturday);
        
        currentWeekStart = new Date(lastSaturday);
        currentWeekEnd = new Date(lastSaturday);
        currentWeekEnd.setDate(lastSaturday.getDate() + 4);
    }
    
    function formatDate(date) {
        if (!date || !(date instanceof Date) || isNaN(date.getTime())) {
            console.warn('ØªØ§Ø±ÙŠØ® ØºÙŠØ± ØµØ­ÙŠØ­ ÙÙŠ formatDate:', date);
            return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }
        
        const day = date.getDate().toString().padStart(2, '0');
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const year = date.getFullYear();
        return `${day}/${month}/${year}`;
    }
    
    function formatDateDisplay(date) {
        if (!date || !(date instanceof Date) || isNaN(date.getTime())) {
            return 'ØªØ§Ø±ÙŠØ® ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }
        
        try {
            const options = { weekday: 'long', day: 'numeric', month: 'long' };
            return date.toLocaleDateString('ar-EG', options);
        } catch (e) {
            console.error('Ø®Ø·Ø£ ÙÙŠ formatDateDisplay:', e);
            return formatDate(date);
        }
    }
    
    function renderWeekDates() {
        const container = document.getElementById('weekDates');
        if (!container) return;
        
        const startDate = formatDate(currentWeekStart);
        const endDate = formatDate(currentWeekEnd);
        
        container.innerHTML = `
            <div class="date-box">
                <div class="date-label">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
                <div class="date-value">${startDate}</div>
            </div>
            <div class="date-box">
                <div class="date-label">Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
                <div class="date-value">${endDate}</div>
            </div>
        `;
    }
    
    function renderDays() {
        const container = document.getElementById('daysContainer');
        if (!container) return;
        
        let html = '';
        
        daysOfWeek.forEach((day, index) => {
            const currentDate = new Date(currentWeekStart);
            currentDate.setDate(currentWeekStart.getDate() + index);
            const dateDisplay = formatDateDisplay(currentDate);
            
            html += `
                <div class="day-card" style="border-right-color: ${day.color}">
                    <div class="day-header">
                        <div class="day-name">
                            <i class="${day.icon} day-icon"></i>
                            ${day.id}
                        </div>
                        <div class="day-date">${dateDisplay}</div>
                    </div>
                    <textarea 
                        id="homework_${day.id}" 
                        class="form-control" 
                        rows="4" 
                        placeholder="Ø£Ø¯Ø®Ù„ ÙˆØ§Ø¬Ø¨ ${day.id} Ù‡Ù†Ø§..."
                        dir="auto"
                    ></textarea>
                </div>
            `;
        });
        
        container.innerHTML = html;
    }
    
    // ============ Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙ†Ù‚Ù„ ============
    function navigateWeek(direction) {
        if (!currentWeekStart) calculateCurrentWeek();
        
        currentWeekStart.setDate(currentWeekStart.getDate() + (direction * 7));
        currentWeekEnd.setDate(currentWeekEnd.getDate() + (direction * 7));
        
        renderWeekDates();
        renderDays();
        
        const grade = document.getElementById('grade')?.value;
        const className = document.getElementById('class')?.value;
        const subject = document.getElementById('subject')?.value;
        
        if (grade && className && subject) {
            setTimeout(loadHomework, 300);
        }
    }
    
    function loadCurrentWeek() {
        calculateCurrentWeek();
        renderWeekDates();
        renderDays();
        
        const grade = document.getElementById('grade')?.value;
        const className = document.getElementById('class')?.value;
        const subject = document.getElementById('subject')?.value;
        
        if (grade && className && subject) {
            setTimeout(loadHomework, 300);
        }
    }
    
    // ============ Ø¯ÙˆØ§Ù„ API ============
    function callAPI(action, data) {
        showLoading(true);
        
        return new Promise((resolve) => {
            const callbackName = 'callback_' + Math.random().toString(36).substr(2, 9);
            const timeoutId = setTimeout(() => {
                cleanup();
                showLoading(false);
                resolve({ 
                    success: false, 
                    error: "Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ (15 Ø«Ø§Ù†ÙŠØ©)" 
                });
            }, 15000);
            
            function cleanup() {
                clearTimeout(timeoutId);
                delete window[callbackName];
                const script = document.getElementById(`script_${callbackName}`);
                if (script && script.parentNode) {
                    script.parentNode.removeChild(script);
                }
            }
            
            window[callbackName] = function(result) {
                cleanup();
                showLoading(false);
                console.log(`âœ… API Response [${action}]:`, result);
                resolve(result);
            };
            
            let url = `${TEACHER_API_URL}?action=${action}&callback=${callbackName}&_t=${Date.now()}`;
            
            if (data && typeof data === 'object') {
                for (const key in data) {
                    if (data[key] !== null && data[key] !== undefined && data[key] !== '') {
                        url += `&${key}=${encodeURIComponent(data[key].toString().trim())}`;
                    }
                }
            }
            
            console.log(`ğŸ“¤ API Request [${action}]:`, url);
            
            const script = document.createElement('script');
            script.id = `script_${callbackName}`;
            script.src = url;
            
            script.onerror = function() {
                cleanup();
                showLoading(false);
                resolve({ 
                    success: false, 
                    error: "âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª - ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø§Ø¨Ø· API ÙˆØ§Ù„Ø£Ø°ÙˆÙ†Ø§Øª" 
                });
            };
            
            document.body.appendChild(script);
        });
    }
    
    // ============ Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ============
    function collectHomeworkDataForSave() {
        const grade = document.getElementById('grade')?.value;
        const className = document.getElementById('class')?.value;
        const subject = document.getElementById('subject')?.value;
        const teacher = document.getElementById('teacher')?.value;
        
        if (!grade || !className || !subject) {
            showMessage('ğŸ“ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙØŒ Ø§Ù„Ø´Ø¹Ø¨Ø©ØŒ ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹', 'info');
            return null;
        }
        
        const data = {
            grade: grade.trim(),
            class: className.trim(),
            section: className.trim(),
            subject: subject.trim(),
            saturdayDate: formatDate(currentWeekStart)
        };
        
        // Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£ÙŠØ§Ù… Ø¨Ø£Ø³Ù…Ø§Ø¡ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ ÙƒÙˆØ¯ Apps Script)
        daysOfWeek.forEach(day => {
            const textarea = document.getElementById(`homework_${day.id}`);
            if (textarea && textarea.value.trim()) {
                data[day.english] = textarea.value.trim();
                data[day.id.toLowerCase()] = textarea.value.trim();
            }
        });
        
        if (teacher && teacher.trim()) {
            data.teacher = teacher.trim();
        }
        
        console.log('ğŸ“ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©:', data);
        return data;
    }
    
    async function loadHomework() {
        const grade = document.getElementById('grade')?.value;
        const className = document.getElementById('class')?.value;
        const subject = document.getElementById('subject')?.value;
        
        if (!grade || !className || !subject) {
            showMessage('ğŸ“ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙØŒ Ø§Ù„Ø´Ø¹Ø¨Ø©ØŒ ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹', 'info');
            return;
        }
        
        const saturdayDate = formatDate(currentWeekStart);
        
        const params = {
            grade: grade,
            section: className,
            subject: subject,
            saturdayDate: saturdayDate
        };
        
        console.log('ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª:', params);
        
        const result = await callAPI('getHomework', params);
        
        if (result.success) {
            if (result.exists) {
                console.log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙˆØ§Ø¬Ø¨Ø§Øª:', result.homework);
                
                // ØªØ¹Ø¨Ø¦Ø© Ø­Ù‚ÙˆÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                daysOfWeek.forEach(day => {
                    const textarea = document.getElementById(`homework_${day.id}`);
                    if (textarea && result.homework[day.id]) {
                        textarea.value = result.homework[day.id] || '';
                    }
                });
                
                // ØªØ¹Ø¨Ø¦Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…
                if (result.teacher) {
                    const teacherInput = document.getElementById('teacher');
                    if (teacherInput) teacherInput.value = result.teacher;
                }
                
                showMessage('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            } else {
                showMessage('ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ§Ø¬Ø¨Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹', 'info');
                clearHomeworkFields();
            }
        } else {
            showMessage('âŒ ' + (result.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'), 'error');
            console.error('ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£:', result);
        }
    }
    
    async function saveHomework() {
        const homeworkData = collectHomeworkDataForSave();
        if (!homeworkData) return;
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ÙˆØ§Ø¬Ø¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„
        const hasHomework = daysOfWeek.some(day => {
            return homeworkData[day.english] || homeworkData[day.id.toLowerCase()];
        });
        
        if (!hasHomework) {
            if (!confirm('âš ï¸ Ø¬Ù…ÙŠØ¹ Ø­Ù‚ÙˆÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª ÙØ§Ø±ØºØ©.\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙÙŠ Ø§Ù„Ø­ÙØ¸ØŸ')) {
                return;
            }
        }
        
        if (!confirm('ğŸ’¾ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­ÙØ¸ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©ØŸ')) {
            return;
        }
        
        console.log('ğŸ’¾ Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', homeworkData);
        
        const result = await callAPI('saveHomework', homeworkData);
        
        if (result.success) {
            showMessage('âœ… ' + (result.message || 'ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø¨Ù†Ø¬Ø§Ø­'), 'success');
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø­ÙØ¸
            setTimeout(() => {
                loadHomework();
            }, 1500);
        } else {
            let errorMessage = result.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸';
            
            // ØªØ­Ø³ÙŠÙ† Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
            if (errorMessage.includes('already exists') || errorMessage.includes('Ù…Ø³Ø¬Ù„Ø© Ø¨Ø§Ù„ÙØ¹Ù„')) {
                errorMessage += '<br><br>ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª" Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø­ÙØ¸';
            }
            
            if (errorMessage.includes('Ù…Ø·Ù„ÙˆØ¨')) {
                errorMessage += '<br><br>ğŸ’¡ ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©';
            }
            
            showMessage('âŒ ' + errorMessage, 'error');
            console.error('ğŸ”´ ØªÙØ§ØµÙŠÙ„ Ø®Ø·Ø£ Ø§Ù„Ø­ÙØ¸:', result);
            
            if (result.details) {
                console.error('ğŸ”´ ØªÙØ§ØµÙŠÙ„ ØªÙ‚Ù†ÙŠØ©:', result.details);
            }
        }
    }
    
    async function updateHomework() {
        const homeworkData = collectHomeworkDataForSave();
        if (!homeworkData) return;
        
        if (!confirm('âœï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ')) {
            return;
        }
        
        console.log('âœï¸ Ø¬Ø§Ø±ÙŠ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', homeworkData);
        
        const result = await callAPI('updateHomework', homeworkData);
        
        if (result.success) {
            showMessage('âœ… ' + (result.message || 'ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø¨Ù†Ø¬Ø§Ø­'), 'success');
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
            setTimeout(() => {
                loadHomework();
            }, 1500);
        } else {
            let errorMessage = result.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„';
            
            if (errorMessage.includes('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ±')) {
                errorMessage += '<br><br>ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "Ø­ÙØ¸ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª" Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙŠØ¯';
            }
            
            showMessage('âŒ ' + errorMessage, 'error');
        }
    }
    
    async function deleteHomework() {
        const grade = document.getElementById('grade')?.value;
        const className = document.getElementById('class')?.value;
        const subject = document.getElementById('subject')?.value;
        
        if (!grade || !className || !subject) {
            showMessage('ğŸ“ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙØŒ Ø§Ù„Ø´Ø¹Ø¨Ø©ØŒ ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹', 'info');
            return;
        }
        
        if (!confirm('âš ï¸ â—â— ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù â—â—\n\nÙ‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ÙˆØ§Ø¬Ø¨Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ØŸ\nÙ‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
            return;
        }
        
        const data = {
            grade: grade,
            class: className,
            subject: subject,
            saturdayDate: formatDate(currentWeekStart)
        };
        
        console.log('ğŸ—‘ï¸ Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', data);
        
        const result = await callAPI('deleteHomework', data);
        
        if (result.success) {
            showMessage('âœ… ' + (result.message || 'ØªÙ… Ø­Ø°Ù Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø¨Ù†Ø¬Ø§Ø­'), 'success');
            clearHomeworkFields();
        } else {
            showMessage('âŒ ' + (result.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù'), 'error');
        }
    }
    
    async function testConnection() {
        console.log('ğŸ”— Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...');
        
        const result = await callAPI('ping');
        if (result && result.success) {
            console.log('âœ… Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ù†Ø§Ø¬Ø­:', result);
            
            let message = `âœ… Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ù†Ø§Ø¬Ø­<br>`;
            message += `ğŸ“‹ ${result.system || 'Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†'}<br>`;
            message += `ğŸ“ ${result.message || 'Ù†Ø´Ø· ÙˆØ¬Ø§Ù‡Ø²'}<br>`;
            message += `ğŸ•’ ${new Date().toLocaleString('ar-SA')}`;
            
            showMessage(message, 'success', 6000);
            
            setTimeout(checkSheetStructure, 2000);
        } else {
            console.error('âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„:', result);
            
            let errorMsg = 'âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù…';
            if (result && result.error) {
                errorMsg += `<br>${result.error}`;
            }
            
            showMessage(errorMsg, 'error', 8000);
        }
    }
    
    async function checkSheetStructure() {
        console.log('ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„...');
        
        const result = await callAPI('getHomework', {
            grade: 'Ø§Ù„Ø«Ø§Ù…Ù†',
            section: 'Ø¨',
            subject: 'Ø±ÙŠØ§Ø¶ÙŠØ§Øª',
            saturdayDate: '27/12/2025'
        });
        
        console.log('Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ù‚Ù‚:', result);
        
        if (result.success) {
            if (result.exists) {
                console.log('âœ… Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                showMessage(
                    'âœ… Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­<br>' +
                    'âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø­ÙØ¸ ÙˆØ§Ù„ØªØ¹Ø¯ÙŠÙ„',
                    'success', 4000
                );
            } else {
                console.log('âš ï¸ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙŠØ¹Ù…Ù„ ÙˆÙ„ÙƒÙ† Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØµÙ Ø§Ù„Ù…Ø­Ø¯Ø¯');
            }
        } else {
            console.warn('âš ï¸ Ù‚Ø¯ ØªÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„:', result.error);
        }
    }
    
    // ============ Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ============
    function clearHomeworkFields() {
        daysOfWeek.forEach(day => {
            const textarea = document.getElementById(`homework_${day.id}`);
            if (textarea) textarea.value = '';
        });
        const teacherInput = document.getElementById('teacher');
        if (teacherInput) teacherInput.value = '';
    }
    
    function clearForm() {
        if (!confirm('ğŸ§¹ Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙØ±ÙŠØº Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ØŸ')) {
            return;
        }
        
        const gradeSelect = document.getElementById('grade');
        const classSelect = document.getElementById('class');
        const subjectSelect = document.getElementById('subject');
        const teacherInput = document.getElementById('teacher');
        
        if (gradeSelect) gradeSelect.selectedIndex = 0;
        if (classSelect) classSelect.selectedIndex = 0;
        if (subjectSelect) subjectSelect.selectedIndex = 0;
        if (teacherInput) teacherInput.value = '';
        
        clearHomeworkFields();
        
        showMessage('ğŸ§¹ ØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„', 'info');
    }
    
    function setupEventListeners() {
        // ØªØ­Ù…ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const fields = ['grade', 'class', 'subject'];
        fields.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('change', function() {
                    const grade = document.getElementById('grade')?.value;
                    const className = document.getElementById('class')?.value;
                    const subject = document.getElementById('subject')?.value;
                    
                    if (grade && className && subject) {
                        setTimeout(() => {
                            loadHomework();
                        }, 300);
                    }
                });
            }
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ø®Ø§ØµÙŠØ© autosave Ù„Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ù†Øµ
        daysOfWeek.forEach(day => {
            const textareaId = `homework_${day.id}`;
            const textarea = document.getElementById(textareaId);
            if (textarea) {
                textarea.addEventListener('blur', function() {
                    const grade = document.getElementById('grade')?.value;
                    const className = document.getElementById('class')?.value;
                    const subject = document.getElementById('subject')?.value;
                    
                    if (grade && className && subject && this.value.trim() !== '') {
                        console.log(`ğŸ“ ØªÙ… ØªØ­Ø¯ÙŠØ« ${day.id}`);
                    }
                });
            }
        });
        
        // Ø¥Ø¶Ø§ÙØ© ØªØ­Ø°ÙŠØ± Ø¥Ø°Ø§ Ø­Ø§ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', function(e) {
            const grade = document.getElementById('grade')?.value;
            const className = document.getElementById('class')?.value;
            const subject = document.getElementById('subject')?.value;
            
            let hasData = false;
            daysOfWeek.forEach(day => {
                const textarea = document.getElementById(`homework_${day.id}`);
                if (textarea && textarea.value.trim()) {
                    hasData = true;
                }
            });
            
            if ((grade || className || subject || hasData)) {
                const confirmationMessage = 'âš ï¸ Ù„Ø¯ÙŠÙƒ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…Ø­ÙÙˆØ¸Ø©. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©ØŸ';
                e.returnValue = confirmationMessage;
                return confirmationMessage;
            }
        });
    }
    
    function showMessage(text, type, duration = 5000) {
        const messageDiv = document.getElementById('message');
        if (!messageDiv) {
            console.error('âŒ Ø¹Ù†ØµØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
            return;
        }
        
        messageDiv.innerHTML = text;
        messageDiv.className = `message ${type}`;
        messageDiv.style.display = 'block';
        
        if (duration > 7000) {
            messageDiv.innerHTML += '<button onclick="this.parentElement.style.display=\'none\'" style="margin-right: 10px; background: rgba(255,255,255,0.2); border: none; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer; float: left;">âœ•</button>';
        }
        
        setTimeout(() => {
            if (messageDiv.style.display !== 'none') {
                messageDiv.style.display = 'none';
            }
        }, duration);
    }
    
    function showLoading(show) {
        const loadingDiv = document.getElementById('formLoading');
        if (loadingDiv) {
            loadingDiv.style.display = show ? 'block' : 'none';
        }
    }
    
    // ============ ØªØ´Ø®ÙŠØµ Ø§Ù„Ù†Ø¸Ø§Ù… ============
    function diagnoseSystem() {
        console.group('===== ØªØ´Ø®ÙŠØµ Ø§Ù„Ù†Ø¸Ø§Ù… =====');
        console.log('1. Ø±Ø§Ø¨Ø· API:', TEACHER_API_URL);
        console.log('2. Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø­Ø§Ù„ÙŠ:', new Date().toLocaleString('ar-SA'));
        
        if (currentWeekStart) {
            console.log('3. ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø¨Øª Ø§Ù„Ø­Ø§Ù„ÙŠ:', formatDate(currentWeekStart));
        } else {
            console.log('3. ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø¨Øª Ø§Ù„Ø­Ø§Ù„ÙŠ:', 'Ù„Ù… ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø¨Ø¹Ø¯');
        }
        
        if (currentWeekEnd) {
            console.log('4. ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡:', formatDate(currentWeekEnd));
        } else {
            console.log('4. ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡:', 'Ù„Ù… ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø¨Ø¹Ø¯');
        }
        
        console.log('5. Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ±:');
        console.log('   - grade:', document.getElementById('grade')?.value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
        console.log('   - class:', document.getElementById('class')?.value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
        console.log('   - subject:', document.getElementById('subject')?.value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯');
        console.log('   - teacher:', document.getElementById('teacher')?.value || 'ÙØ§Ø±Øº');
        
        console.log('6. Ø­Ø§Ù„Ø© Ø­Ù‚ÙˆÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª:');
        daysOfWeek.forEach(day => {
            const textarea = document.getElementById(`homework_${day.id}`);
            console.log(`   - ${day.id}:`, textarea?.value ? 'Ù…Ù…Ù„ÙˆØ¡' : 'ÙØ§Ø±Øº');
        });
        
        console.groupEnd();
        
        console.log('ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹...');
        fetch(TEACHER_API_URL + '?action=ping&_t=' + Date.now())
            .then(response => response.text())
            .then(data => {
                console.log('âœ… Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø³ÙŠØ±ÙØ±:', data.substring(0, 100) + '...');
            })
            .catch(error => {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„:', error);
            });
    }
    
    // ============ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„ ============
    setTimeout(() => {
        console.log('âœ… Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† Ù…Ø­Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­');
        console.log('ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø¸Ø§Ù…:', new Date().toISOString());
        console.log('ğŸ”— Ø±Ø§Ø¨Ø· API Ø§Ù„Ù…Ø­Ø¯Ø¯:', TEACHER_API_URL);
        
        setTimeout(diagnoseSystem, 1000);
    }, 500);
    
    setTimeout(() => {
        console.log('ğŸ” Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ...');
        
        if (TEACHER_API_URL && !TEACHER_API_URL.includes('...')) {
            console.log('âœ… Ø±Ø§Ø¨Ø· API Ù…Ø­Ø¯Ø¯ØŒ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...');
        } else {
            console.warn('âš ï¸ Ø±Ø§Ø¨Ø· API ØºÙŠØ± Ù…Ø­Ø¯Ø¯ Ø£Ùˆ ØºÙŠØ± ØµØ­ÙŠØ­');
            showMessage(
                'âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø§Ø¨Ø· API<br>' +
                'ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† "Ù†Ø´Ø± ÙƒØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨" ÙÙŠ Google Apps Script',
                'error',
                10000
            );
        }
    }, 2000);
    
    // Ø¥Ø¶Ø§ÙØ© Ø£ÙˆØ§Ù…Ø± Ù„Ù„ØªØ­ÙƒÙ… Ù…Ù† ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…
    window.diagnose = diagnoseSystem;
    window.testAPI = testConnection;
    window.reloadData = loadHomework;
    window.clearAll = clearForm;
    window.saveTest = async function() {
        const testData = {
            grade: 'Ø§Ù„Ø«Ø§Ù…Ù†',
            class: 'Ø¨',
            subject: 'Ø±ÙŠØ§Ø¶ÙŠØ§Øª',
            saturdayDate: '28/12/2025',
            teacher: 'Ø§Ø®ØªØ¨Ø§Ø±',
            saturday: 'ÙˆØ§Ø¬Ø¨ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ø¨Øª',
            sunday: 'ÙˆØ§Ø¬Ø¨ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø­Ø¯'
        };
        console.log('ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­ÙØ¸:', testData);
        const result = await callAPI('saveHomework', testData);
        console.log('Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:', result);
        return result;
    };
    
    console.log('ğŸ’¡ Ø£ÙˆØ§Ù…Ø± ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…ØªØ§Ø­Ø©:');
    console.log('   - diagnose(): ØªØ´Ø®ÙŠØµ Ø§Ù„Ù†Ø¸Ø§Ù…');
    console.log('   - testAPI(): Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„');
    console.log('   - reloadData(): Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
    console.log('   - clearAll(): ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù…ÙˆØ°Ø¬');
    console.log('   - saveTest(): Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­ÙØ¸');
    </script>
</body>
</html>